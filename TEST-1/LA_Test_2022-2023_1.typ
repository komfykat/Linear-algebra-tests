    #import "test_template.typ": *
#import "../typst-sympy-calculator.typ": *
#let title = "КР 1. 2022/2023 учебный год. Вариант 1"
#let author = "Морфей"
#let course = "Линейная алгебра и геометрия"
#let group = "Группа БЭАД242"
#show: footer_header.with(title, author, course, group)
#show: title_page.with(title, author, course, group)
#show: template

#problem[
Решите уравнение $2 A X = tr(A X) dot B$ относительно неизвестной матрицы $X$, где $A = 
display(mat(2, -11, 8;
            1, -5, 3)), B = 
display(mat(2, 0;
            -1, 1))$.
]
#solution[
В правой части матрица $tr(A X) dot B$ размера $2 times 2$, т.к. $tr(A X) in RR$. Значит, раз матрица $A$ имеет размер $2 times 3$, то размер $X - $ $3 times 2$. \
Пусть $Y = A X -$ матрица размера $2 times 2$. Имеем уравнение 
$2 Y = tr(Y) dot B$.
Найдём $B^(-1)$ по формуле:
$
B^(-1) = 1/2 dot 
mat(1, 0;
    1, 2) = 
mat(1/2, 0;
    1/2, 1)
$
Домножим обе части уравнения $2Y = tr(Y) B$ слева на $B^(-1)$:
$
2B^(-1)Y = B^(-1) dot tr(Y) dot B = tr(Y) B^(-1) B = tr(Y) dot E 
$
Имеем следующее уравнение:
$
mat(1, 0;
    1, 2) Y = tr(Y) dot E
$
Пусть $Y = 
display(mat(a, b;
            c, d))$. Найдём левую часть:
$
mat(1, 0;
    1, 2)
mat(a, b;
    c, d) = 
mat(a, b;
    a + 2c, b + 2d) = (a + d) dot E = 
mat(a + d, 0;
    0, a + d)
$
Значит,
$
cases(a = a + d,
      b = 0,
      a + 2c = 0
      b + 2d = a + d)
$
Из первого уравнения $d = 0$. Тогда из четвёртого уравнения следует, что $a = b = 0$. Значит, из третьего $c = 0$. Такимо образом,
$
Y = 
mat(0, 0;
    0, 0), y in RR
$
Значит, имеем 
$
A X = 0 <=> 
mat(2, -11, 8;
    1, -5, 3) X = 
mat(0, 0;
    0, 0)
$
Применим метод Гаусса для следующей расширенной матрицы:
$
mat(2, -11, 8, 0, 0;
    1, -5, 3, 0, 0; augment:#(3)) 
stretch(->)^((1) - 2 times(2))
mat(0, -1, 2, 0, 0;
    1, -5, 3, 0, 0; augment:#(3)) 
stretch(->)^((1) <->(2))
mat(1, -5, 3, 0, 0;
    0, -1, 2, 0, 0; augment:#(3)) 
stretch(->)^((1) - 5 times (2))
$
]
#pagebreak()
#solution(no_header: true)[
$
stretch(->)^((1) - 5 times (2))
mat(1, 0, -7, 0, 0;
    0, -1, 2, 0, 0; augment:#(3)) 
stretch(->)^(-1 times (2))
mat(1, 0, -7, 0, 0;
    0, 1, -2, 0, 0; augment:#(3)) 
$
Значит, 
$
X = 
mat(7x_1, 7x_2;
    2x_1, 2x_2;
    x_1, x_2), "где " x_1, x_2 in RR.
$
]
#answer[
$
mat(7x_1, 7x_2;
    2x_1, 2x_2;
    x_1, x_2), "где " x_1, x_2 in RR.
$
]
#pagebreak()
#problem[
Дана система линейных уравнений 
$
cases(5x_1 + 3x_2 + x_3 + 7x_4 = -1,
      3x_1 + b x_2 + 7x_3 + x_4 = -7,
      2x_1 - x_2 - 4x_3 + 5x_4 = 4)
$
Определите все значения параметра $b$, для которых эта система имеет ровно две свободных неизвестных, и для каждого найденного значения $b$ выпишите соответствующее общее решение системы.
]
#solution[
*1.* Запишем соответствующую данной СЛУ расширенную матрицу и приведём её к СВ:
$
mat(5, 3, 1, 7, -1;
    3, b, 7, 1, -7;
    2, -1, -4, 5, 4; augment:#(-1))
stretch(->)^((1) - ((2) + (3)), (2) - (3))
mat(0, 4-b, -2, 1, 2;
    1, b + 1, 11, -4, -11;
    2, -1, -4, 5, 4; augment:#(-1))
stretch(->)^((3) - 2 times (2)) \ stretch(->)^((3) - 2 times (2))
mat(0, 4-b, -2, 1, 2;
    1, b + 1, 11, -4, -11;
    0, -3 - 2b, -26, 13, 26; augment:#(-1))
stretch(->)^((1) <-> (2))
mat(1, b + 1, 11, -4, -11;
    0, 4-b, -2, 1, 2;
    0, -3 - 2b, -26, 13, 26; augment:#(-1))
$
*2.* Если $b = 4$, то матрица имеет вид
$
mat(1, 5, 11, -4, -11;
    0, 0, -2, 1, 2;
    0, -10, -26, 13, 26; augment:#(-1)) <->^((2) <->(3))
mat(1, 5, 11, -4, -11;
    0, -10, -26, 13, 26;
    0, 0, -2, 1, 2; augment:#(-1)) 
$
В этой матрице $3$ главные неизвестные. Значит, этот случай не подходит. \
*3.* Значит, $b != 4$. Тогда прибавим к третьей строчке вторую, умноженную на $display((2b+3)/(4-b))$. Получим следующую матрицу:
$
mat(1, b + 1, 11, -4, -11;
    0, 4-b, -2, 1, 2;
    0, 0, -26 -2((2b+3)/(4-b)), 13 + (2b+3)/(4-b), 26 + 2(2b+3)/(4-b); augment:#(-1))
$
Раз в этой матрице должно быть ровно две свободные неизвестные, то 
$
-26 - 2(2b+3)/(4-b) = 0 <=> (2b+3)/(4-b) = -13 <=> 2b+3 = -52 + 13b <=> 11b=55 <=> b = 5.
$
Подставим $b = 5$:
$
mat(1, 6, 11, -4, -11;
    0, -1, -2, 1, 2;
    0, 0, 0, 0, 0; augment:#(-1)) 
stretch(->)^((1) + 6 times (2), (-1) times (2))
mat(1, 0, -1, 2, 1;
    0, 1, 2, -1, -2;
    0, 0, 0, 0, 0; augment:#(-1))
$
Значит, 
$
cases(x_1 = 1 + x_3 - 2x_4,
      x_2 = -2 - 2x_3 + x_4,
      x_3 in RR,
      x_4 in RR)
$
]
#answer[

$
b = 5, #h(2cm)
cases(x_1 = 1 + x_3 - 2x_4,
      x_2 = -2 - 2x_3 + x_4,
      x_3 in RR,
      x_4 in RR)
$
]
#pagebreak()
#problem[
Две перестановки $sigma, tau in S_7$ заданы своими разложениями в произведение независимых циклов как $sigma = (1275)(46)$ и $tau = (137)(45)$. Найдите $(sigma tau)^73$ и $rho = (tau sigma^(-1))^78$.
]
#solution[
*1.* Найдём $sigma tau = (1275)(46) compose (137)(45) = (13564)(27).$ \

Тогда 
$(sigma tau)^73 = (13564)^(73) (27)^(73) = (13564)^3 (27) = (16345)(27) = display(mat(1, 2, 3, 4, 5, 6, 7;
            6, 7, 4, 5, 1, 3, 2)).$ \

*2.* 
$
sigma = (1275)(46) = 
mat(1, 2, 3, 4, 5, 6, 7;
    2, 7, 3, 6, 1, 4, 5) <=> sigma^(-1) = 
mat(1, 2, 3, 4, 5, 6, 7;
    5, 1, 3, 6, 7, 4, 2) = (1572)(46)
$
Тогда 
$
tau compose sigma^(-1) = (137)(45)(1572)(46) = (1465)(237) => rho = (tau sigma^(-1))^78 = (1465)^78 (237)^78 = (1465)^2 compose id = (16)(45) = \ = 
mat(1, 2, 3, 4, 5, 6, 7;
    6, 2, 3, 5, 4, 1, 7)
$
]
#answer[
$(16345)(27) = display(mat(1, 2, 3, 4, 5, 6, 7;
            6, 7, 4, 5, 1, 3, 2))$ и $rho = (16)(45) = display(mat(1, 2, 3, 4, 5, 6, 7;
    6, 2, 3, 5, 4, 1, 7))$
]
#pagebreak()
#problem[
Найдите коэффициент при $x^5$ в выражении определителя 
$
mat(1, 2, -1, x, 3;
    x, -3, 1, -1, x^2;
    2, -4, x, 3, -1;
    3, x, 2, 1, x;
    0, x, 1, 5, -2;
    delim:"|")
$
]
#solution[
*1.*
Предположим, что мы НЕ берём $x^2$ из последнего столбца. Тогда, т.к. матрица размера $5 times 5$, то из каждого столбца мы должны взять $x$. Вариантов так сделать ровно $1$, ему соответствует перестановка $4, 1, 3, 5, 2$. Посчитаем её знак:
$
mat(1, 2, 3, 4, 5;
    4, 1, 3, 5, 2) = (1452) = (14)(45)(52) - "нечётная перестановка"
$
Значит, получим $-x^5$. \
*2.* 
Теперь предположим, что мы взяли $x^2$ из последнего столбца. Заметим, что тогда мы не можем взять $x_21$ и $x_45$. Значит, всего в матрице осталось только три столбца, из которых мы должны взять $x$. Сделать это два варианта, им соответствуют перестановки $(4, 5, 3, 2, 1)$ и $(4, 5, 3, 1, 2)$. В первом случае мы полчуаем $0 dot x^5$, а во втором $3x^5$. Посчитаем знак второй перестановки:
$
mat(1, 2, 3, 4, 5;
    4, 5, 3, 1, 2) = (14)(25) - "чётная перестановка"
$ 
Получаем $3x^5$. \
Итого, коэффициент при $x^5$ равен $3 - 1 = 2$.
]
#answer[
$2$
]
#pagebreak()
#problem[
Про матрицу $A in M_4(RR)$ известно, что она обратима и 
$
A^(-1) = 
mat(0, 2, 1, 0;
    3, 3, 0, 4;
    0, 2, 0, 0;
    2, 1, 0, 3)
$
Выясните, обратима ли матрица $2A - E$.
]
#solution[
Имеем $A^(-1) dot A = E$. Решим это уравнение методом Гаусса: 
$
mat(0, 2, 1, 0, 1, 0, 0, 0;
    3, 3, 0, 4, 0, 1, 0, 0;
    0, 2, 0, 0, 0, 0, 1, 0;
    2, 1, 0, 3, 0, 0, 0, 1; augment:#(4))
stretch(->)^((2) - (4))
mat(0, 2, 1, 0, 1, 0, 0, 0;
    1, 2, 0, 1, 0, 1, 0, -1;
    0, 2, 0, 0, 0, 0, 1, 0;
    2, 1, 0, 3, 0, 0, 0, 1; augment:#(4))
stretch(->)^((4) - 2(2))
mat(0, 2, 1, 0, 1, 0, 0, 0;
    1, 2, 0, 1, 0, 1, 0, -1;
    0, 2, 0, 0, 0, 0, 1, 0;
    0, -3, 0, 1, 0, -2, 0, 3; augment:#(4))
stretch(->)^((1) <->(2)) \ stretch(->)^((1) <->(2))
mat(1, 2, 0, 1, 0, 1, 0, -1;
    0, 2, 1, 0, 1, 0, 0, 0;
    0, 2, 0, 0, 0, 0, 1, 0;
    0, -3, 0, 1, 0, -2, 0, 3; augment:#(4)) 
stretch(->)^((1) - (2), (3) - (2))
mat(1, 0, -1, 1, -1, 1, 0, -1;
    0, 2, 1, 0, 1, 0, 0, 0;
    0, 0, -1, 0, -1, 0, 1, 0;
    0, -3, 0, 1, 0, -2, 0, 3; augment:#(4)) 
stretch(->)^((2) + (4)) \ stretch(->)^((2) + (4))
mat(1, 0, -1, 1, -1, 1, 0, -1;
    0, -1, 1, 1, 1, -2, 0, 3;
    0, 0, -1, 0, -1, 0, 1, 0;
    0, -3, 0, 1, 0, -2, 0, 3; augment:#(4)) 
stretch(->)^((4) - 3 times (2), (-1) times (2))
mat(1, 0, -1, 1, -1, 1, 0, -1;
    0, 1, -1, -1, -1, 2, 0, -3;
    0, 0, -1, 0, -1, 0, 1, 0;
    0, 0, -3, -2, -3, 4, 0, -6; augment:#(4)) 
stretch(->)^((-1) times (3)) \ stretch(->)^((-1) times (3))
mat(1, 0, -1, 1, -1, 1, 0, -1;
    0, 1, -1, -1, -1, 2, 0, -3;
    0, 0, 1, 0, 1, 0, -1, 0;
    0, 0, -3, -2, -3, 4, 0, -6; augment:#(4)) 
stretch(->)^((1) + (3), (2) + (3), (4) + 3 times (3))
mat(1, 0, 0, 1, 0, 1, -1, -1;
    0, 1, 0, -1, 0, 2, -1, -3;
    0, 0, 1, 0, 1, 0, -1, 0;
    0, 0, 0, -2, 0, 4, -3, -6; augment:#(4)) 
stretch(->)^(1/2 times 4) \ stretch(->)^(-1/2 times (4))
mat(1, 0, 0, 1, 0, 1, -1, -1;
    0, 1, 0, -1, 0, 2, -1, -3;
    0, 0, 1, 0, 1, 0, -1, 0;
    0, 0, 0, 1, 0, -2, 3/2, 3; augment:#(4)) 
stretch(->)^((1) - (4), (2) + (4))
mat(1, 0, 0, 0, 0, 3, -5/2, -4;
    0, 1, 0, 0, 0, 0, 1/2, 0;
    0, 0, 1, 0, 1, 0, -1, 0;
    0, 0, 0, 1, 0, -2, 3/2, 3; augment:#(4)) 
$
Слева получили единичную матрицу. Значит,
$
A = 
mat(0, 3, -5/2, -4;
    0, 0, 1/2, 0;
    1, 0, -1, 0;
    0, -2, 3/2, 3)
$
$
2A - E = 
mat(0, 6, -5, -8;
    0, 0, 1, 0;
    2, 0, -2, 0;
    0, -4, 3, 6) - 
mat(1, 0, 0, 0;
    0, 1, 0, 0;
    0, 0, 1, 0;
    0, 0, 0, 1) = 
mat(-1, 6, -5, -8;
    0, -1, 1, 0;
    2, 0, -3, 0;
    0, -4, 3, 5)
$
Выясним, обратима ли матрица $2A - E$. Для этого надо найти её определитель.
$
mat(-1, 6, -5, -8;
    0, -1, 1, 0;
    2, 0, -3, 0;
    0, -4, 3, 5; delim:"|") stretch(=)^((3) + 2 times (1))
mat(-1, 6, -5, -8;
    0, -1, 1, 0;
    0, 12, -13, -16;
    0, -4, 3, 5; delim:"|")
$
Разложим по первому столбцу:
$
mat(-1, 6, -5, -8;
    0, -1, 1, 0;
    0, 12, -13, -16;
    0, -4, 3, 5; delim:"|") = (-1) dot (-1)^(1+1) 
mat(-1, 1, 0;
    12, -13, -16;
    -4, 3, 5; delim: "|") = -
mat(-1, 1, 0;
    12, -13, -16;
    -4, 3, 5; delim: "|")    
$
Разложим по первой строке:
$
mat(-1, 1, 0;
    12, -13, -16;
    -4, 3, 5; delim: "|") = (-1) dot (-1)^(1+1) dot 
mat(-13, -16;
    3, 5; delim: "|") + 1 dot (-1)^(1 + 2) dot 
mat(12, -16;
    -4, 5; delim: "|") = -(-65 + 48) - (60 - 64) = \ = 17 + 4 = 21
$
Значит, искомый определитель равен $-21 != 0 => 2A - E -$ обратимая матрица.
]
#answer[
Обратима.
]
#pagebreak()
#problem[
В матрице
$
A = 
mat(2, 3, 8, 0;
    -5, 7, 5, 2;
    -1, 5, 7, 1;
    1, 5, -2, 1)
$
выбраны три строки $A_((i)), A_((j)), A_((k))$ (не обязательно попарно различных) и вместо строки $A_((i))$ записали сумму $A_((j)) + A_((k))$. Определите все возможные значения, которые может принимать определитель результирующей.
]
#solution[
Переберём все возможные наборы $i, j$ и $k$: \
*1.* Предположим, что $i, j, k -$ попарно различные числа. Тогда мы из строки $i$ можем вычесть строки $j$ и $k$ и получим нулевую строку. В этом случае определитель результирующей матрицы будет равен $0$. \
*2.* Если $j = k$, то мы можем из строки $i$ вычесть строку $j$, умноженную на $2$, и вновь получим нулевую строку. Значит, в этом случае опредеолитель результирующей матрицы тоже будет равен $0$. \
*3.* Предположим, что $i = j != k$. Тогда по свойству определителя, если мы представим $A'_((i)) = A_((i)) + A_((k))$, то можем представить $det A = det A + det A''$, где $A'' -$ матрица, где вместо строки $i$ стоит строка $j$. Тогда в матрице $A''$ две одинаковые строки, и её определитель равен нулю. Значит, $det A' = det A$. \
Если $i = k$, то рассуждения аналогичны и $det A' = det A$. \
*4.* Предположим, что $i = j = k$. Тогда получим матрицу $A'$, равную матрицу $A$, в которой $i$-ая строка умножена на $2$, значит $det(A') = 2det(A)$. \
Таким образом, $det A' = det A$, $det A' = 2 det A$ или $det A' = 0$. Посчитаем $det A$: \
$
mat(2, 3, 8, 0;
    -5, 7, 5, 2;
    -1, 5, 7, 1;
    1, 5, -2, 1; delim: "|") 
stretch(=)^((4) + (3), (1) + 2 times (3))
mat(0, 13, 22, 2;
    -5, 7, 5, 2;
    -1, 5, 7, 1;
    0, 10, 5, 2; delim: "|") 
stretch(=)^((2) - 5 times (3))
mat(0, 13, 22, 2;
    0, -18, -30, -3;
    -1, 5, 7, 1;
    0, 10, 5, 2; delim: "|") 
stretch(=)^((1) <-> (3)) \ stretch(=)^((1) <-> (3)) -
mat(-1, 5, 7, 1;
    0, -18, -30, -3;
    0, 13, 22, 2;
    0, 10, 5, 2; delim: "|") 
stretch(=)^((-1) times (1))
mat(1, -5, -7, -1;
    0, -18, -30, -3;
    0, 13, 22, 2;
    0, 10, 5, 2; delim: "|") 
= 1 dot (-1)^(1+1)
mat(-18, -30, -3;
    13, 22, 2;
    10, 5, 2; delim: "|") = \ = -3
mat(6, 10, 1;
    13, 22, 2;
    10, 5, 2; delim: "|")
stretch(=)^((2) - 2 times (1), (3) - 2 times (1)) -3
mat(6, 10, 1;
    1, 2, 0;
    -2, -15, 0; delim: "|") = -3 dot 1 dot (1)^(1 + 3) dot 
mat(1, 2;
    -2, -15; delim: "|") = -3 (-15 + 4)= 33.
$
]
#answer[
$66$, $33$ или $0$.
]
