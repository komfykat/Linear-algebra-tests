#import "../EXAM-1/exam_template.typ": *
#import "../typst-sympy-calculator.typ": *
#let title = "КР-2. 2020/2021 учебный год. Вариант 1"
#let author = "Морфей"
#let course = "Линейная алгебра и геометрия"
#let group = "Группа БЭАД242"
#show: footer_header.with(title, author, course, group)
#show: title_page.with(title, author, course, group)
#show: template
#show link: underline

#problem[
  Найдите базис пересечения двух подпространств $L_1, L_2 subset.eq RR^4$, где $L_1$ есть линейная оболочка векторов $(3, 2, 3, -2), (2, 2, 3, 1), (3, 1, 4, -3)$, а $L_2$ состоит из всех решений уравнения $2x_1 - x_2 - x_3 + 2x_4 = 0$.
]
#solution[
  Пересечение удобно находить, если задать оба подпространства СЛУ. Приведём $L_1$ к СЛУ по известному алгоритму:
  $
    mat(3, 2, 3, -2;
        2, 2, 3, 1;
        3, 1, 4, -3) => "УСВ:"
    mat(1, 0, 0, -3; 0, 1, 0, 2; 0, 0, 1, 1)
  $
  ФСР:
  $
    vec(x_1, x_2, x_3, x_4) =
    vec(3, -2, -1, 1)x_4
  $
  Тогда искомая СЛУ
  $
    mat(3, -2, -1, 1)
  $
  $
    vec(x_1, x_2, x_3, x_4) =
    vec(2/3, 1, 0, 0) x_2 +
    vec(1/3, 0, 1, 0) x_3 +
    vec(-1/3, 0, 0, 1) x_4
  $
  или
  $
    3x_1 - 2x_2 - x_3 + x_4 = 0
  $
  Тогда пересечение задаётся СЛУ
  $
    cases(
      3x_1 - 2x_2 - x_3 + x_4 = 0,
      2x_1 - x_2 - x_3 + 2x_4 = 0
    )
  $
  Найдём ФСР:
  $
    mat(3, -2, -1, 1;
        2, -1, -1, 2) => "УСВ:"
    mat(1, 0, -1, 3; 0, 1, -1, 4)
  $
  $
    vec(x_1, x_2, x_3, x_4) =
    vec(1, 1, 1, 0)x_3 +
    vec(-3, -4, 0, 1)x_4
  $
  Эти два вектора и есть искомый базис.
]
#pagebreak()
#answer[
  $
    { vec(1, 1, 1, 0),
      vec(-3, -4, 0, 1) }
  $
]
#pagebreak()

#problem[
  Рассмотрим линейное отображение $phi: RR[x]_(<=3) -> RR[x]_(<=2), f arrow.bar f' - f(1) dot x^2$. Найдите базис $bb(e)$ пространства $RR[x]_(<=3)$ и базис $bb(f)$ пространства $RR[x]_(<=2)$, в которых $phi$ имеет диагональный вид с единицами и нулями на диагонали, и выпишите этот вид.
]
#solution[
  Выпишем матрицу линейного отображения в базисах ${1, x, x^2, x^3}, {1, x, x^2}$. \
  Пусть $f(x) = d + c x + b x^2 + a x^3$. Тогда:
  $
    f' = c + 2 b x + 3 a x^2
  $
  $
    f(1) dot x^2 = (d + c + b + a) x^2
  $
  $
    phi(f) = c + 2 b x + 3 a x^2 - (d + c + b + a) x^2 = c + 2 b x + (- d - c - b + 2a)x^2
  $
  $
    phi(d + c x + b x^2 + a x^3) = c + 2 b x + (- d - c - b + 2 a) x^2
  $
  $
    phi(1) = -x^2
  $
  $
    phi(x) = 1 - x^2
  $
  $
    phi(x^2) = 2 x - x^2
  $
  $
    phi(x^3) = 2x^2
  $
  Имеем матрицу линейного отображения в этой паре базисов:
  $
    mat(0, 1, 0, 0;
        0, 0, 2, 0;
        -1, -1, -1, 2)
  $
  Найдём $ker phi$:
  $
    mat(0, 1, 0, 0;
        0, 0, 2, 0;
        -1, -1, -1, 2) -->
    mat(1, 1, 1, -2;
        0, 1, 0, 0;
        0, 0, 1, 0) -->
    mat(1, 0, 0, -2;
        0, 1, 0, 0;
        0, 0, 1, 0)
  $
  $
    vec(x_1, x_2, x_3, x_4) =
    vec(2, 0, 0, 1)x_4
  $
  Дополним его до базиса $RR^4$. Ясно, что можно взять
  $
    bb(e) =
    { vec(1, 0, 0, 0),
      vec(0, 1, 0, 0),
      vec(0, 0, 1, 0),
      vec(2, 0, 0, 1) } =
    {1, x, x^2, 2 + x^3}
  $
  Это искомый базис $bb(e)$. Положим
  $
    f_1 = phi(e_1) = phi(1) = -x^2
  $
  $
    f_2 = phi(e_2) = phi(x) = 1 - x^2
  $
  $
    f_3 = phi(e_3) = phi(x^2) = 2x - x^2
  $
  Это и есть искомый базис. \
  Из УСВ матрицы $rk phi = 3$, значит, матрица в этих базисах имеет вид
  $
    mat(1, 0, 0, 0;
        0, 1, 0, 0;
        0, 0, 1, 0)
  $
  Проверка:
  $
    mat(0, 1, 0;
        0, 0, 2;
        -1, -1, -1)^(-1)
    mat(0, 1, 0, 0;
        0, 0, 2, 0;
        -1, -1, -1, 2)
    mat(1, 0, 0, 2;
        0, 1, 0, 0;
        0, 0, 1, 0;
        0, 0, 0, 1) = mat(1, 0, 0, 0; 0, 1, 0, 0; 0, 0, 1, 0)
  $
]
#answer[
  $
    bb(e) = {1, x, x^2, 2 + x^3}
  $
  $
    bb(f) = {-x^2, 1-x^2, 2x-x^2}
  $
  $
    mat(1, 0, 0, 0;
        0, 1, 0, 0;
        0, 0, 1, 0)
  $
]
#pagebreak()

#problem[
  Пусть $beta$ --- билинейная форма на пространстве $V = RR[x]_(<=2)$, имеющая в базисе $x + 2x^2, x^2, 1-x^2$ матрицу $display(mat(1, 3, 1; 0, 1, 0; 1, 0, 2))$. Рассмотрим линейные функции $alpha_1, alpha_2, alpha_3$ на $V$ такие, что $alpha_1 (f) = beta(f, 1), alpha_2 (f) = beta(f, x), alpha_3 (f) = beta(f, x^2)$ для всех $f in V$. Найдите базис пространства $V$, для которого $(alpha_1, alpha_2, alpha_3)$ является двойственным базисом пространства $V^*$.
]
#solution[
  Пусть $bb(e) = (1, x, x^2), bb(f) = (x + 2x^2, x^2, 1-x^2)$. Найдём матрицу перехода от $bb(e)$ к $bb(f)$:
  $
    bb(f) = bb(e) dot
    mat(0, 0, 1;
        1, 0, 0;
        2, 1, -1) = bb(e) dot C
  $
  Тогда
  $
    bb(e) =
    bb(f) dot
    mat(0, 0, 1;
        1, 0, 0;
        2, 1, -1)^(-1) = bb(f) dot C^(-1)
  $
  Найдём обратную:
  $
    mat(0, 0, 1, 1, 0, 0;
        1, 0, 0, 0, 1, 0;
        2, 1, -1, 0, 0, 1; augment: #3) => "УСВ:"
    mat(1, 0, 0, 0, 1, 0; 0, 1, 0, 1, -2, 1; 0, 0, 1, 1, 0, 0; augment: #3)
  $
  Имеем
  $
    C^(-1) =
    mat(0, 1, 0;
        1, -2, 1;
        1, 0, 0) = D
  $
  Тогда в базисе $bb(f)$ матрица $beta$ имеет вид
  $
    D^T A D =
    mat(0, 1, 1;
        1, -2, 0;
        0, 1, 0)
    mat(1, 3, 1;
        0, 1, 0;
        1, 0, 2)
    mat(0, 1, 0;
        1, -2, 1;
        1, 0, 0) = mat(3, -1, 1; 2, -1, 1; 1, -2, 1)
  $
  Найдём $alpha_1, alpha_2, alpha_3$ для $f = c + b x + a x^2$.
  $
    alpha_1 (f) = beta(f, 1) = beta(c + b x + a x^2, 1) = c beta(1, 1) + b beta(x, 1) + a beta(x^2, 1) = 3c + 2b + a = (3, 2, 1)
  $
  Аналогично
  $
    alpha_2 (f) = -c - b - 2a = (-1, -1, -2)
  $
  $
    alpha_3 (f) = c + b + a = (1, 1, 1)
  $
  Матрица $alpha$:
  $
    alpha =
    mat(3, 2, 1;
        -1, -1, -2;
        1, 1, 1)
  $
  Осталось найти обратную.
  $
    mat(3, 2, 1, 1, 0, 0;
        -1, -1, -2, 0, 1, 0;
        1, 1, 1, 0, 0, 1; augment: #3) =>
    "УСВ:"
    mat(1, 0, 0, 1, -1, -3; 0, 1, 0, -1, 2, 5; 0, 0, 1, 0, -1, -1; augment: #3)
  $
  Матрица базисов
  $
    mat(1, -1, -3;
        -1, 2, 5;
        0, -1, -1) =>
    {1 - x, -1 + 2x - x^2, -3 + 5x - x^2} - "искомый базис"
  $
]
#answer[
  ${1 - x, -1 + 2x - x^2, -3 + 5x - x^2}$
]
#pagebreak()

#problem[
  Билинейная форма $beta$ на пространстве $RR^3$ имеет в стандартном базисе матрицу
  $
    mat(0, 0, -5;
        1, 0, -3;
        1, 3, 0)
  $
  Найдите невырожденную замену координат (выражение старых координат через новые), приводящую квадратичную форму $Q(x) colon.eq beta(x, x)$ к нормальному виду, и выпишите этот вид.
]
#solution[
  Запишем матрицу $Q(x)$ в стандартном базисе (она равна $1/2 (A + A^T)$):
  $
    mat(0, 1/2, -2;
        1/2, 0, 0;
        -2, 0, 0)
  $
  Воспользуемся симметричным Гауссом и найдём нормальный вид.
  $
    mat(0, 1/2, -2, 1, 0, 0;
        1/2, 0, 0, 0, 1, 0;
        -2, 0, 0, 0, 0, 1; augment: #3) stretch(->)^((1) + (2))
    mat(1, 1/2, -2, 1, 1, 0;
        1/2, 0, 0, 0, 1, 0;
        -2, 0, 0, 0, 0, 1; augment: #3) stretch(->)^(2 times (2))
    mat(1, 1, -2, 1, 1, 0;
        1, 0, 0, 0, 2, 0;
        -2, 0, 0, 0, 0, 1; augment: #3) stretch(->)^((2) - (1)) \ -->
    mat(1, 0, -2, 1, 1, 0;
        0, -1, 2, -1, 1, 0;
        -2, 2, 0, 0, 0, 1; augment: #3) stretch(->)^((3) + 2 times (1))
    mat(1, 0, 0, 1, 1, 0;
        0, -1, 2, -1, 1, 0;
        0, 2, -4, 2, 2, 1; augment: #3) stretch(->)^((3) + 2 times (2))
    mat(1, 0, 0, 1, 1, 0;
        0, -1, 0, -1, 1, 0;
        0, 0, 0, 0, 4, 1; augment:#3)
  $
  $
    C = mat(1, -1, 0;
        1, 1, 4;
        0, 0, 1) - "матрица перехода к искомому базису"
  $
  Нормальный вид:
  $
    x^2_1 - x^2_2
  $
  Замена координат (соответствующие коэффициенты стоят в строчках):
  $
    x_1 = x'_1 + x'_2
  $
  $
    x_2 = -x'_1 + x'_2
  $
  $
    x_3 = 4x'_2 + x'_3
  $
]
#pagebreak()

#problem[
  В евклидовом пространстве $RR^4$ со стандартным скалярным произведением найдите расстояние от вектора $v = (2, 3, 1, 4)$ до подпространства
  $
    U = linspan((2, -1, -1, 2), (1, -2, 2, 4), (5, -1, -5, 2))
  $
]
#solution[
  Найдём базис подпространства:
  $
    mat(2, 1, 5;
        -1, -2, -1;
        -1, 2, -5;
        2, 4, 2) =>
    mat(1, 0, 3; 0, 1, -1; 0, 0, 0; 0, 0, 0)
  $
  Тогда
  $
    vec(2, -1, -1, 2), vec(1, -2, 2, 4) - "базис" U
  $
  Можно было бы провести ортогонализацию, но это уже было в следующих годах, так что воспользуемся другим способом: \
  Пусть
  $
    A =
    mat(2, 1;
        -1, -2;
        -1, 2;
        2, 4)
  $
  Тогда
  $
    pr_U (v) = A (A^T A)^(-1) A^T v
  $
  Найдём.
  $
    A^T A =
    mat(2, -1, -1, 2;
        1, -2, 2, 4)
    mat(2, 1;
        -1, -2;
        -1, 2;
        2, 4) =
    mat(10, 10;
        10, 25) => (A^T A)^(-1) = 1 / (250 - 100) mat(25, -10; -10, 10) = \ = 1 / 150 mat(25, -10; -10, 10) =
    mat(1/6, -1/15;
        -1/15, 1/15)
  $
  $
    A (A^T A)^(-1) =
    mat(2, 1;
        -1, -2;
        -1, 2;
        2, 4)
    mat(1/6, -1/15;
        -1/15, 1/15) = mat(4/15, -1/15; -1/30, -1/15; -3/10, 1/5; 1/15, 2/15)
  $
  $
    A^T v =
    mat(2, -1, -1, 2;
        1, -2, 2, 4)
    mat(2; 3; 1; 4) =
    mat(8; 14)
  $
  $
    pr_U v =
    mat(4/15, -1/15; -1/30, -1/15; -3/10, 1/5; 1/15, 2/15)
    mat(8; 14) = mat(6/5; -6/5; 2/5; 12/5)
  $
  Тогда
  $
    ort_U v =
    v - pr_U v =
    mat(2; 3; 1; 4) - mat(6/5; -6/5; 2/5; 12/5) = mat(4/5; 21/5; 3/5; 8/5)
  $
  $
    rho(v, U) = 1 / 5 sqrt(4^2 + 21^2 + 3^2 + 8^2) = sqrt(530) / 5
  $
]
#answer[
  $
    sqrt(530) / 5
  $
]
#pagebreak()

#problem[
  В пространстве $RR^3$ со стандартным скалярным произведением задан тетраэдр с вершинами $A(-1, 1, 7), B(5, -2, 1), C(4, 2, -2), D(9, 2, 3)$. Пусть $A H$ --- высота грани $A C D$, а $B L$ --- биссектриса грани $A B D$. Найдите угол и расстояние мжеду прямыми $A H$ и $B L$.
]
#solution[
  Пусть у $A H$ направляющий вектор $(a, b, c)$.
  $
    arrow(A C) = vec(4, 2, -2) - vec(-1, 1, 7) = vec(5, 1, -9)
  $
  $
    arrow(A D) = vec(9, 2, 3) - vec(-1, 1, 7) = vec(10, 1, -4)
  $
  $
    arrow(C D) =
    vec(9, 2, 3) - vec(4, 2, -2) = vec(5, 0, 5)
  $
  $
    A H perp C D => a + c = 0
  $
  Далее, $A H, A C$ и $A D$ лежат в одной плоскости. Значит,
  $
    0 =
    det
    mat(5, 1, -9;
        10, 1, -4;
        a, b, c) = (5 c - 4 a - 90 b) - (-9a - 20 b + 10 c) = 5 a - 70 b - 5 c <=> a - 14 b - c = 0
  $
  Имеем $c = -a => a - 14 b + a = 0 => a = 7 b$, Имеем вектор $(7 b, b, -7 b) ~ (7, 1, -7) = arrow(n)$.


  Опишем биссектрису. Рисуночек от Тагира:
  #align(center)[
    #image("biss_from_tagir.jpg", width: 80%)
  ]
  Тогда направляющий вектор $B L$ равен $arrow(l) = abs(B D) dot arrow(B A) + abs(B A) dot arrow(B D)$. Имеем:
  $
    arrow(B A) = vec(-1, 1, 7) - vec(5, -2, 1) = vec(-6, 3, 6), abs(B A) = sqrt(36 + 9 + 36) = 9
  $
  $
    arrow(B D) = vec(9, 2, 3) - vec(5, -2, 1) = vec(4, 4, 2) => abs(B D) = sqrt(16 + 16 + 4) = 6
  $
  $
    arrow(l) = 6 vec(-6, 3, 6) + 9 vec(4, 4, 2) = vec(0, 54, 54) ~ vec(0, 1, 1)
  $
  Имеем \
  $B L:$ опорная точка $B(5, -2, 1)$, направляющий вектор $arrow(l) = (0, 1, 1)$. \
  $A H :$ опорная точка $A(-1, 1, 7)$, направляющий вектор $arrow(n) = (7, 1, -7)$. \
  Найдём угол между ними:
  $
    abs(l) = sqrt(2), abs(n) = sqrt(99) = 3sqrt(11)
  $
  $
    (l, n) = 1 - 7 = -6
  $
  $
    cos angle(l, n) = (-6) / (3sqrt(22)) => alpha = arccos (2 / sqrt(22))
  $
  $
    sin^2 alpha = 1 - 4 / 22 = 18 / 22 = 9 / 11 => sin alpha = 3 / sqrt(11)
  $
  Найдём расстояние между ними по известной формуле.
  $
    "Vol" (arrow(A B), arrow(l), arrow(n)) =
    abs(det
    mat(
      6, -3, -6;
      0, 1, 1;
      7, 1, -7)) =
    abs(
    6 (-7 - 1) + 7 (-3 + 6)) = 27
  $
  $
    rho = 27 / (3 / sqrt(11) dot sqrt(2) dot 3sqrt(11)) = 3 / sqrt(2)
  $
]
#answer[
  $
    alpha = arccos(2/sqrt(22)), rho = 3 / sqrt(2)
  $
]
